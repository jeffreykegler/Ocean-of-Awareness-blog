<html>
<head>
<link rel="alternate" title="Ocean of Awareness RSS" type="application/rss+xml" title="RSS" href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/index.rss" />
<title>Ocean of Awareness</title>
<style type="text/css">
   strong {font-weight: 700;}
</style>
</head>
<body>
<div
  style="color:white;background-color:#38B0C0;padding:1em;clear:left;text-align:center;">
<h1>Ocean of Awareness</h1>
</div>
  <div style="margin:0;padding:10px 30px 10px 10px;width:150px;float:left;border-right:2px solid #38B0C0">
  <p>
  <strong>Jeffrey Kegler's blog</strong>
  about Marpa, his new parsing algorithm,
    and other topics of interest</p>
  <p><a href="http://www.jeffreykegler.com/">Jeffrey's personal website</a></p>
      <p>
	<a href="https://twitter.com/jeffreykegler" class="twitter-follow-button" data-show-count="false">Follow @jeffreykegler</a>
      </p>
      <p style="text-align:center">
	<!-- Place this code where you want the badge to render. -->
	<a href="//plus.google.com/101567692867247957860?prsrc=3" rel="publisher" style="text-decoration:none;">
	<img src="//ssl.gstatic.com/images/icons/gplus-32.png" alt="Google+" style="border:0;width:32px;height:32px;"/></a>
      </p>
  <h3>Marpa resources</h3>
  <p><a href="http://jeffreykegler.github.com/Marpa-web-site/">The Marpa website</a></p>
  <p>The Ocean of Awareness blog: <a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog">home page</a>,
  <a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/metapages/chronological.html">chronological index</a>,
  and
  <a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/metapages/annotated.html">annotated index</a>.
  </p>
  </div>
  <div style="margin-left:190px;border-left:2px solid #38B0C0;padding:25px;">
<h3>Sat, 20 Apr 2013</h3>
<br />
<center><a name="procedural"> <h2>Marpa's SLIF adds procedural parsing</h2> </a>
</center>
  <p>
      <!--
      marpa_r2_html_fmt --no-added-tag-comment --no-ws-ok-after-start-tag
      -->
    <p>
      Marpa's SLIF (scanless interface)
      allows an application to parse directly from any BNF grammar.
      Marpa parses vast classes of grammars in linear time,
      including all those classes currently in practical use.
      With its latest release, Marpa::R2's SLIF
      also allows application to intermix their own custom lexing and parsing logic
      with Marpa's,
      and to switch back and forth between them.
      Among other things, this means that Marpa's SLIF can do procedural parsing.
    </p>
    <h3>What is procedural parsing?</h3>
    <p>Procedural parsing is parsing using
    ad hoc code in a procedural language.
    Procedural parsing 
    may be described as what you do when you've given up
    on your parsing algorithm.
    Modern programmers are accustomed to procedural parsing,
    and some problems which are best tackled that way.
    <h3>An example</h3>
    <p>
    One such problem is parsing Perl-style here-documents.
    Peter Stuifzand has tackled this using the
    just-released version of Marpa::R2.
    For those unfamiliar, Perl allows documents to be incorporated
    into its source files in line-oriented fashion,
    and here-documents can be used in expressions.
    The syntax to do this is very handy, if more than a little strange.
    For example,
    </p>
    <blockquote><pre>
say &lt;&lt;ENDA, &lt;&lt;ENDB, &lt;&lt;ENDC; say &lt;&lt;ENDD;
a
ENDA
b
ENDB
c
ENDC
d
ENDD
    </pre></blockquote>
starts with a single line declaring four here-documents spread out
over two <tt>say</tt> statements.
The expressions of the form <tt>&lt;&lt;ENDX</tt> are here-document expressions.
<tt>&lt;&lt;</tt> is the heredoc operator.
The string which follows it (in this case, <tt>ENDA</tt>, 
<tt>ENDB</tt>, etc.) is the heredoc terminator string --
the string that will signal end
of the here-document.
The body of the here-documents follow, in order, over the next eight lines.
<p>All of this poses quite a challenge to a parser-lexer combination.
There are a few ways Marpa could approach this.
The one
Peter Stuifzand chose was to
to read the
here-document as the value of the terminator in
each <tt>&lt;&lt;ENDX</tt> expression.
<p>
In more detail, the strategy works this way:
Marpa allows the application to mark certain lexemes as "pause" lexemes.
Whenever a "pause" lexeme is encountered, Marpa's internal scanning stops,
and control is handed over to the application.
In this case, the application is set up to pause after every newline,
and before the terminator in every here-document expression.
</p>
<p>
While reading the line containing the four here-document expressions,
the Marpa's internal scanner pauses before every here-document terminator.
Custom Marpa-external logic takes over from the internal scanner,
and the external logic reads the terminator.
The custom logic then skips ahead to read the here-document's body,
returns that to the SLIF grammar as the value of the heredoc terminator,
and asks Marpa's internal scanner to resume parsing after the heredoc terminator.
This is done four times, one for each here-document.
<p>As mentioned, Marpa also pauses and hands control over to external
logic after each newline.
This allows the external logic to check if any here-documents were read
in the current line.
If so, Marpa is told to skip past them before resuming parsing.
<p>A compact example is in
<a href="https://gist.github.com/jeffreykegler/5431739">a
Github gist</a>.
One with more tests is in
<a href="https://github.com/jeffreykegler/demo-heredoc-parser">my
fork</a> of
<a href="https://github.com/pstuifzand/demo-heredoc-parser">a
of Peter Stuifzand's github repository</a>.
    </p>
    <p>
      Marpa's latest version is
      <a href="https://metacpan.org/module/Marpa::R2">Marpa::R2,
        which is available on CPAN</a>.
      Recently, it has gained immensely in "whipitupitude" with
      <a href="https://metacpan.org/module/JKEGL/Marpa-R2-2.048000/pod/Scanless/DSL.pod">
        a new interface</a>,
      which has tutorials
      <a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/individual/2013/01/dsl_simpler2.html">here
      </a>
      and
      <a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/individual/2013/01/announce_scanless.html">
        here</a>.
      Marpa has
      <a href="http://jeffreykegler.github.com/Marpa-web-site/">a web page</a>,
      and of course it is the focus of
      <a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/">
        my "Ocean of Awareness" blog</a>.
    </p>
    <p>
      Comments on this post
      can be sent to the Marpa's Google Group:
      <code>marpa-parser@googlegroups.com</code>
    </p>
<br />
<p>posted at: 23:39 |
<a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/individual/2013/04/procedural.html">direct link to this entry</a>
</p>
<div style="color:#38B0C0;padding:1px;text-align:center;">
&sect;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&sect;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&sect;
</div>
</div>
</div>
<div id="footer" style="border-top:thick solid #38B0C0;clear:left;padding:1em;">
<p>This is Ocean of Awareness's
  new home.  This blog has been hosted at
  <a href="http://blogs.perl.org/users/jeffrey_kegler/">blogs.perl.org</a>
  but I have succumbed to the lure of static blogging.
  I have not yet decided how to deal with comments at this new blog location.
If the post is Marpa-related,
<a href="https://groups.google.com/forum/?hl=en&fromgroups#%21forum/marpa-parser">
the Marpa mailing list</a>
is a good place to comment.
</div>
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-33430331-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>
</body></html>
