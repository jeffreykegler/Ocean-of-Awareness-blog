Exploiting ambiguity in language design
<html>
  <head>
  </head>
  <body><p>
      <!--
      marpa_r2_html_fmt --no-added-tag-comment --no-ws-ok-after-start-tag
      -->
      Currently, in designing lanuages,
      we don't allow even potential ambiguity.
      That is, not only must a program be unambiguous, it must not be
      even
      <b>possible</b>
      to write an ambiguous program.
      This is overly restrictive.  In fact, Perl 5 syntax is not just
      potentially ambiguous, it is potentially undecidable.
    </p>
    <p>
      This post is written in English, which is full of ambiguities.
      Natural languages are always ambiguous.
      Human beings arrange things so that (if all goes well) every
      sentence is unambiguous in context.
      That can break down, but in conversation that's no problem --
      we just ask for clarification.
    </p>
    <p>Ambiguity is a powerful tool for creating a flexible, compact
      language. It is a tool that
      we can use in designing programming languages.
      We can allow our computer languages to take their natural form,
      which will often have the potential for ambiguity.
      When
      <b>actual</b>
      ambiguities occur, we can treat them just like
      any other syntax problem:
      We can catch it and report it.
    </p>
    <h3>An example</h3>
    <p>
      To illustrate,
      I'll use a DSL-writing DSL language.
      It'll be tiny -- even toy -- just lexeme declarations and BNF rules.
      Newlines will
      <b>not</b>
      be significant.
      Statements can end with s semicolon, but it's optional.
      (The code for this post is in
      <a href="https://gist.github.com/jeffreykegler/ed64bf00983f7be666bc">
        a Github gist</a>.)
    </p>
    <p>Here is an example in that language DSL-writing language
      -- a tiny calculator.
    </p><blockquote>
      <pre>
  Number matches '\d+'
  E ::= T '*' F
  E ::= T
  T ::= F '+' Number
  T ::= Number
</pre>
    </blockquote>
    <h3>Trying an improvement</h3>
    <p>The previous description of a calculator
      has the lexeme declaration at the beginning, but I
      think it looks better coming just after where the symbol
      <tt>Number</tt>
      is used.
      True, with this toy calculator, it really does not make much difference,
      but if our grammar was longer, the difference in readability would be major.
      So we move the lexeme declaraion to the end:
    </p><blockquote>
      <pre>
  E ::= T '*' F
  E ::= T
  T ::= F '+' Number
  T ::= Number
  Number matches '\d+'
</pre>
    </blockquote>
    <p>
    </p><blockquote>
      <pre>
Parse of BNF/Scanless source is ambiguous
Length of symbol "Statement" at line 4, column 1 is ambiguous
  Choices start with: T ::= Number
  Choice 1, length=12, ends at line 4, column 12
  Choice 1: T ::= Number
  Choice 2, length=33, ends at line 5, column 20
  Choice 2: T ::= Number\nNumber matches '\\d
</pre></blockquote>
    <h3>A fix</h3>
    <p>
    </p><blockquote>
      <pre>
  E ::= T '*' F
  E ::= T
  T ::= F '+' Number
  T ::= Number ;
  Number matches '\d+'
</pre>
    </blockquote>
    <h3>To learn more</h3>
    <p>
      <a href="https://metacpan.org/module/Marpa::R2">Marpa::R2
        is available on CPAN</a>.
      A list of my Marpa tutorials can be found
      <a href="http://jeffreykegler.github.io/Ocean-of-Awareness-blog/metapages/annotated.html#TUTORIAL">
        here</a>.
      There are
      new tutorials by
      <a href="http://marpa-guide.github.io/chapter1.html">Peter Stuifzand</a>
      and
      <a href="http://longanswers.blogspot.de/2013/06/transforming-syntax.html">amon</a>.
      <a href="http://jeffreykegler.github.com/Ocean-of-Awareness-blog/">
        The Ocean of Awareness blog</a>
      focuses on Marpa,
      and it has
      <a href="http://jeffreykegler.github.io/Ocean-of-Awareness-blog/metapages/annotated.html">an annotated guide</a>.
      Marpa has
      <a href="http://jeffreykegler.github.com/Marpa-web-site/">a web page that I maintain</a>
      and Ron Savage maintains
      <a href="http://savage.net.au/Perl-modules/html/marpa.papers/index.html">
        another</a>.
      For questions, support and discussion, there is
      <a href="http://groups.google.com/group/marpa-parser">
        the "marpa parser"
        Google Group.</a>
    </p>
    <h3>Comments</h3>
    <p>
      Comments on this post can be made in
      <a href="http://groups.google.com/group/marpa-parser">
        Marpa's Google group</a>.
    </p>
  </body>
</html>
